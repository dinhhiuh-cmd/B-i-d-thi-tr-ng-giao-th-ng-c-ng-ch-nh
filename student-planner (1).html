<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Planner</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Segoe UI', sans-serif; background: #f0f4f8; color: #2d3748; }

  header {
    background: #fff; border-bottom: 1px solid #e2e8f0;
    padding: 16px 32px; display: flex; align-items: center; justify-content: space-between;
    position: sticky; top: 0; z-index: 100; box-shadow: 0 1px 4px rgba(0,0,0,0.06);
  }
  header h1 { font-size: 1.3rem; font-weight: 700; color: #3b82f6; }
  header span { font-size: 0.85rem; color: #94a3b8; }

  nav { display: flex; gap: 8px; background: #fff; padding: 12px 32px; border-bottom: 1px solid #e2e8f0; }
  nav button { padding: 8px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: 500; background: #f1f5f9; color: #64748b; transition: all .2s; }
  nav button.active { background: #3b82f6; color: #fff; }
  nav button:hover:not(.active) { background: #e2e8f0; }

  main { padding: 24px 32px; max-width: 1200px; margin: 0 auto; }
  .section { display: none; }
  .section.active { display: block; }

  /* SCHEDULE */
  .week-nav { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
  .week-nav button { background: #fff; border: 1px solid #e2e8f0; border-radius: 8px; padding: 6px 14px; cursor: pointer; font-size: 0.85rem; color: #64748b; }
  .week-nav button:hover { background: #f1f5f9; }
  .week-nav span { font-weight: 600; font-size: 0.95rem; }

  .schedule-grid { background: #fff; border-radius: 12px; border: 1px solid #e2e8f0; overflow: hidden; }
  .grid-header { display: grid; grid-template-columns: 70px repeat(7, 1fr); background: #f8fafc; border-bottom: 1px solid #e2e8f0; }
  .grid-header div { padding: 10px 6px; text-align: center; font-size: 0.78rem; font-weight: 600; color: #64748b; border-right: 1px solid #e2e8f0; }
  .grid-header div:last-child { border-right: none; }
  .grid-header div.today-col { color: #3b82f6; background: #eff6ff; }

  .time-row { display: grid; grid-template-columns: 70px repeat(7, 1fr); border-bottom: 1px solid #f1f5f9; min-height: 48px; }
  .time-label { padding: 4px 8px 0; font-size: 0.72rem; color: #94a3b8; text-align: right; border-right: 1px solid #e2e8f0; }
  .day-cell { border-right: 1px solid #f1f5f9; position: relative; min-height: 48px; }
  .day-cell:last-child { border-right: none; }
  .day-cell.today-col { background: #fafbff; }
  .class-block {
    position: absolute; left: 2px; right: 2px; border-radius: 6px;
    padding: 4px 6px; font-size: 0.72rem; font-weight: 600; cursor: pointer;
    overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
    z-index: 2; box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  .class-block:hover { opacity: .85; }
  .add-class-btn { margin-top: 12px; background: #3b82f6; color: #fff; border: none; border-radius: 8px; padding: 9px 18px; cursor: pointer; font-size: 0.87rem; font-weight: 500; }
  .add-class-btn:hover { background: #2563eb; }

  /* TASKS */
  .toolbar { display: flex; gap: 10px; margin-bottom: 16px; flex-wrap: wrap; align-items: center; }
  .toolbar select { padding: 8px 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; background: #fff; outline: none; }
  .toolbar select:focus { border-color: #3b82f6; }
  .add-btn { margin-left: auto; background: #3b82f6; color: #fff; border: none; border-radius: 8px; padding: 8px 18px; cursor: pointer; font-size: 0.87rem; font-weight: 500; }
  .add-btn:hover { background: #2563eb; }

  .task-list { display: flex; flex-direction: column; gap: 10px; }
  .task-card { background: #fff; border-radius: 10px; border: 1px solid #e2e8f0; padding: 14px 16px; display: flex; align-items: center; gap: 14px; transition: box-shadow .15s; }
  .task-card:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.07); }
  .subject-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
  .task-info { flex: 1; }
  .task-name { font-weight: 600; font-size: 0.9rem; margin-bottom: 3px; }
  .task-meta { font-size: 0.78rem; color: #94a3b8; display: flex; gap: 12px; flex-wrap: wrap; }
  .deadline-near { color: #ef4444 !important; font-weight: 600; }
  .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; cursor: pointer; border: none; white-space: nowrap; }
  .status-todo { background: #fef3c7; color: #92400e; }
  .status-doing { background: #dbeafe; color: #1e40af; }
  .status-done { background: #dcfce7; color: #166534; }
  .del-btn { background: none; border: none; color: #cbd5e1; cursor: pointer; font-size: 1rem; padding: 4px; border-radius: 4px; }
  .del-btn:hover { color: #ef4444; background: #fef2f2; }

  /* APPOINTMENTS */
  .apt-list { display: flex; flex-direction: column; gap: 10px; }
  .apt-card { background: #fff; border-radius: 10px; border: 1px solid #e2e8f0; padding: 14px 16px; display: flex; align-items: flex-start; gap: 14px; }
  .apt-card:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.07); }
  .apt-icon { font-size: 1.4rem; flex-shrink: 0; margin-top: 2px; }
  .apt-info { flex: 1; }
  .apt-title { font-weight: 600; font-size: 0.92rem; margin-bottom: 4px; }
  .apt-meta { font-size: 0.78rem; color: #64748b; display: flex; flex-wrap: wrap; gap: 10px; }
  .reminder-badge { background: #eff6ff; color: #2563eb; border-radius: 6px; font-size: 0.72rem; padding: 2px 8px; display: inline-block; }

  /* MODAL */
  .modal-bg { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.35); z-index: 200; align-items: center; justify-content: center; }
  .modal-bg.open { display: flex; }
  .modal { background: #fff; border-radius: 14px; padding: 28px; width: 100%; max-width: 440px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); }
  .modal h2 { font-size: 1.05rem; font-weight: 700; margin-bottom: 18px; color: #1e293b; }
  .form-group { margin-bottom: 14px; }
  .form-group label { display: block; font-size: 0.8rem; font-weight: 600; color: #64748b; margin-bottom: 5px; }
  .form-group input, .form-group select { width: 100%; padding: 9px 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.87rem; outline: none; font-family: inherit; }
  .form-group input:focus, .form-group select:focus { border-color: #3b82f6; }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
  .btn-cancel { background: #f1f5f9; color: #64748b; border: none; border-radius: 8px; padding: 9px 18px; cursor: pointer; font-size: 0.87rem; }
  .btn-cancel:hover { background: #e2e8f0; }
  .btn-save { background: #3b82f6; color: #fff; border: none; border-radius: 8px; padding: 9px 18px; cursor: pointer; font-size: 0.87rem; font-weight: 600; }
  .btn-save:hover { background: #2563eb; }

  .empty-state { text-align: center; padding: 48px 0; color: #94a3b8; font-size: 0.9rem; }
  .empty-state div { font-size: 2.5rem; margin-bottom: 10px; }
</style>
</head>
<body>

<header>
  <h1>üìö Student Planner</h1>
  <span id="today-date"></span>
</header>

<nav>
  <button class="active" onclick="showSection('schedule', this)">üìÖ Th·ªùi Kh√≥a Bi·ªÉu</button>
  <button onclick="showSection('tasks', this)">üìù B√†i T·∫≠p</button>
  <button onclick="showSection('appointments', this)">üóìÔ∏è ƒê·∫∑t H·∫πn</button>
</nav>

<main>
  <!-- SCHEDULE -->
  <section id="schedule" class="section active">
    <div class="week-nav">
      <button onclick="changeWeek(-1)">‚Üê Tu·∫ßn tr∆∞·ªõc</button>
      <span id="week-label"></span>
      <button onclick="changeWeek(1)">Tu·∫ßn sau ‚Üí</button>
      <button onclick="changeWeek(0)" style="margin-left:auto">H√¥m nay</button>
    </div>
    <div class="schedule-grid">
      <div class="grid-header" id="grid-header"></div>
      <div class="grid-body" id="grid-body"></div>
    </div>
    <button class="add-class-btn" onclick="openModal('class')">+ Th√™m m√¥n h·ªçc</button>
  </section>

  <!-- TASKS -->
  <section id="tasks" class="section">
    <div class="toolbar">
      <select id="filter-subject" onchange="renderTasks()"><option value="">T·∫•t c·∫£ m√¥n</option></select>
      <select id="filter-status" onchange="renderTasks()">
        <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
        <option value="todo">Ch∆∞a l√†m</option>
        <option value="doing">ƒêang l√†m</option>
        <option value="done">Ho√†n th√†nh</option>
      </select>
      <button class="add-btn" onclick="openModal('task')">+ Th√™m b√†i t·∫≠p</button>
    </div>
    <div class="task-list" id="task-list"></div>
  </section>

  <!-- APPOINTMENTS -->
  <section id="appointments" class="section">
    <div class="toolbar">
      <button class="add-btn" onclick="openModal('apt')">+ Th√™m cu·ªôc h·∫πn</button>
    </div>
    <div class="apt-list" id="apt-list"></div>
  </section>
</main>

<!-- MODAL CLASS -->
<div class="modal-bg" id="modal-class">
  <div class="modal">
    <h2>üìñ Th√™m m√¥n h·ªçc</h2>
    <div class="form-group"><label>T√™n m√¥n</label><input id="c-name" placeholder="VD: To√°n Cao C·∫•p"></div>
    <div class="form-row">
      <div class="form-group"><label>Th·ª©</label>
        <select id="c-day">
          <option value="1">Th·ª© 2</option><option value="2">Th·ª© 3</option>
          <option value="3">Th·ª© 4</option><option value="4">Th·ª© 5</option>
          <option value="5">Th·ª© 6</option><option value="6">Th·ª© 7</option>
          <option value="0">Ch·ªß nh·∫≠t</option>
        </select>
      </div>
      <div class="form-group"><label>M√†u s·∫Øc</label><input type="color" id="c-color" value="#3b82f6" style="height:38px;padding:2px 6px;"></div>
    </div>
    <div class="form-row">
      <div class="form-group"><label>B·∫Øt ƒë·∫ßu</label><input type="time" id="c-start" value="07:00"></div>
      <div class="form-group"><label>K·∫øt th√∫c</label><input type="time" id="c-end" value="09:00"></div>
    </div>
    <div class="form-group"><label>Ph√≤ng h·ªçc</label><input id="c-room" placeholder="VD: A101"></div>
    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeModal('class')">H·ªßy</button>
      <button class="btn-save" onclick="saveClass()">L∆∞u</button>
    </div>
  </div>
</div>

<!-- MODAL TASK -->
<div class="modal-bg" id="modal-task">
  <div class="modal">
    <h2>üìù Th√™m b√†i t·∫≠p</h2>
    <div class="form-group"><label>T√™n b√†i</label><input id="t-name" placeholder="VD: B√†i t·∫≠p ch∆∞∆°ng 3"></div>
    <div class="form-group"><label>M√¥n h·ªçc</label>
      <select id="t-subject"><option value="">-- Ch·ªçn m√¥n --</option></select>
    </div>
    <div class="form-row">
      <div class="form-group"><label>Deadline</label><input type="datetime-local" id="t-deadline"></div>
      <div class="form-group"><label>Tr·∫°ng th√°i</label>
        <select id="t-status">
          <option value="todo">Ch∆∞a l√†m</option>
          <option value="doing">ƒêang l√†m</option>
          <option value="done">Ho√†n th√†nh</option>
        </select>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeModal('task')">H·ªßy</button>
      <button class="btn-save" onclick="saveTask()">L∆∞u</button>
    </div>
  </div>
</div>

<!-- MODAL APT -->
<div class="modal-bg" id="modal-apt">
  <div class="modal">
    <h2>üóìÔ∏è Th√™m cu·ªôc h·∫πn</h2>
    <div class="form-group"><label>Ti√™u ƒë·ªÅ</label><input id="a-title" placeholder="VD: G·∫∑p gi√°o vi√™n h∆∞·ªõng d·∫´n"></div>
    <div class="form-row">
      <div class="form-group"><label>B·∫Øt ƒë·∫ßu</label><input type="datetime-local" id="a-start"></div>
      <div class="form-group"><label>K·∫øt th√∫c</label><input type="datetime-local" id="a-end"></div>
    </div>
    <div class="form-group"><label>ƒê·ªãa ƒëi·ªÉm</label><input id="a-location" placeholder="VD: Ph√≤ng B205"></div>
    <div class="form-group"><label>Nh·∫Øc nh·ªü tr∆∞·ªõc</label>
      <select id="a-remind">
        <option value="">Kh√¥ng nh·∫Øc</option>
        <option value="10">10 ph√∫t</option>
        <option value="30">30 ph√∫t</option>
        <option value="60">1 gi·ªù</option>
        <option value="1440">1 ng√†y</option>
      </select>
    </div>
    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeModal('apt')">H·ªßy</button>
      <button class="btn-save" onclick="saveApt()">L∆∞u</button>
    </div>
  </div>
</div>

<script>
let data = { classes: [], tasks: [], appointments: [] };

async function loadData() {
  try { const r = await window.storage.get('planner-data'); if (r) data = JSON.parse(r.value); } catch(e) {}
  init();
}
async function saveData() {
  try { await window.storage.set('planner-data', JSON.stringify(data)); } catch(e) {}
}

function showSection(id, btn) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  btn.classList.add('active');
  if (id === 'tasks') { populateSubjectFilter(); renderTasks(); }
  if (id === 'appointments') renderApts();
  if (id === 'schedule') renderSchedule();
}

// ---- SCHEDULE ----
const DAYS = ['T2','T3','T4','T5','T6','T7','CN'];
const HOURS = [];
for (let h = 6; h <= 20; h++) HOURS.push(h);
let weekOffset = 0;

function getWeekDates(offset=0) {
  const now = new Date();
  const day = now.getDay();
  const monday = new Date(now);
  monday.setDate(now.getDate() - (day===0?6:day-1) + offset*7);
  monday.setHours(0,0,0,0);
  return Array.from({length:7}, (_,i) => { const d=new Date(monday); d.setDate(monday.getDate()+i); return d; });
}

function changeWeek(dir) {
  weekOffset = dir===0 ? 0 : weekOffset+dir;
  renderSchedule();
}

function renderSchedule() {
  const dates = getWeekDates(weekOffset);
  const today = new Date(); today.setHours(0,0,0,0);
  const fmt = d => `${d.getDate()}/${d.getMonth()+1}`;
  document.getElementById('week-label').textContent = `Tu·∫ßn ${fmt(dates[0])} ‚Äì ${fmt(dates[6])}/${dates[6].getFullYear()}`;

  const hdr = document.getElementById('grid-header');
  hdr.innerHTML = '<div></div>';
  dates.forEach((d,i) => {
    const isToday = d.getTime()===today.getTime();
    hdr.innerHTML += `<div class="${isToday?'today-col':''}">${DAYS[i]}<br><small style="font-weight:400">${d.getDate()}/${d.getMonth()+1}</small></div>`;
  });

  const body = document.getElementById('grid-body');
  body.innerHTML = '';
  HOURS.forEach(h => {
    const row = document.createElement('div');
    row.className = 'time-row';
    row.innerHTML = `<div class="time-label">${h}:00</div>`;
    dates.forEach((d,di) => {
      const isToday = d.getTime()===today.getTime();
      const cell = document.createElement('div');
      cell.className = `day-cell${isToday?' today-col':''}`;
      const classDayVal = di < 6 ? di+1 : 0;
      data.classes.forEach(c => {
        if (parseInt(c.day) !== classDayVal) return;
        const [sh,sm] = c.start.split(':').map(Number);
        const [eh,em] = c.end.split(':').map(Number);
        if (sh !== h) return;
        const dur = (eh*60+em)-(sh*60+sm);
        const el = document.createElement('div');
        el.className = 'class-block';
        el.style.cssText = `background:${c.color}22;color:${c.color};border-left:3px solid ${c.color};top:${(sm/60)*100}%;height:${(dur/60)*48}px`;
        el.title = `${c.name}${c.room?' | '+c.room:''}\n${c.start}‚Äì${c.end}`;
        el.textContent = c.name+(c.room?` (${c.room})`:'');
        el.onclick = () => deleteClass(c.id);
        cell.appendChild(el);
      });
      row.appendChild(cell);
    });
    body.appendChild(row);
  });
}

function openModal(type) {
  if (type==='task') populateTaskSubject();
  document.getElementById(`modal-${type}`).classList.add('open');
}
function closeModal(type) { document.getElementById(`modal-${type}`).classList.remove('open'); }

function saveClass() {
  const name = document.getElementById('c-name').value.trim();
  if (!name) return alert('Vui l√≤ng nh·∫≠p t√™n m√¥n!');
  const c = {
    id: Date.now(), name,
    day: parseInt(document.getElementById('c-day').value),
    color: document.getElementById('c-color').value,
    start: document.getElementById('c-start').value,
    end: document.getElementById('c-end').value,
    room: document.getElementById('c-room').value.trim()
  };
  data.classes.push(c); saveData(); closeModal('class'); renderSchedule();
  document.getElementById('c-name').value=''; document.getElementById('c-room').value='';
}

function deleteClass(id) {
  if (confirm('X√≥a m√¥n h·ªçc n√†y?')) { data.classes=data.classes.filter(c=>c.id!==id); saveData(); renderSchedule(); }
}

// ---- TASKS ----
function populateSubjectFilter() {
  const sel = document.getElementById('filter-subject');
  const cur = sel.value;
  sel.innerHTML = '<option value="">T·∫•t c·∫£ m√¥n</option>';
  data.classes.forEach(c => { sel.innerHTML += `<option value="${c.name}"${c.name===cur?' selected':''}>${c.name}</option>`; });
}
function populateTaskSubject() {
  const sel = document.getElementById('t-subject');
  sel.innerHTML = '<option value="">-- Ch·ªçn m√¥n --</option>';
  data.classes.forEach(c => { sel.innerHTML += `<option value="${c.name}">${c.name}</option>`; });
}
function saveTask() {
  const name = document.getElementById('t-name').value.trim();
  if (!name) return alert('Vui l√≤ng nh·∫≠p t√™n b√†i!');
  data.tasks.push({ id:Date.now(), name, subject:document.getElementById('t-subject').value, deadline:document.getElementById('t-deadline').value, status:document.getElementById('t-status').value });
  saveData(); closeModal('task'); populateSubjectFilter(); renderTasks();
  document.getElementById('t-name').value=''; document.getElementById('t-deadline').value='';
}
function cycleStatus(id) {
  const t = data.tasks.find(x=>x.id===id); if(!t) return;
  t.status = {todo:'doing',doing:'done',done:'todo'}[t.status];
  saveData(); renderTasks();
}
function deleteTask(id) { data.tasks=data.tasks.filter(t=>t.id!==id); saveData(); renderTasks(); }
function renderTasks() {
  const filterSub = document.getElementById('filter-subject')?.value||'';
  const filterStat = document.getElementById('filter-status')?.value||'';
  const now = new Date();
  let tasks = data.tasks.filter(t => (!filterSub||t.subject===filterSub)&&(!filterStat||t.status===filterStat));
  tasks.sort((a,b) => {
    if (a.status==='done'&&b.status!=='done') return 1;
    if (a.status!=='done'&&b.status==='done') return -1;
    if (a.deadline&&b.deadline) return new Date(a.deadline)-new Date(b.deadline);
    return 0;
  });
  const el = document.getElementById('task-list');
  if (!tasks.length) { el.innerHTML='<div class="empty-state"><div>üì≠</div>Ch∆∞a c√≥ b√†i t·∫≠p n√†o</div>'; return; }
  el.innerHTML = tasks.map(t => {
    const cls = data.classes.find(c=>c.name===t.subject);
    const color = cls?cls.color:'#94a3b8';
    const statusLabel = {todo:'Ch∆∞a l√†m',doing:'ƒêang l√†m',done:'Ho√†n th√†nh'}[t.status];
    let deadlineStr='', deadlineClass='';
    if (t.deadline) {
      const dl = new Date(t.deadline);
      deadlineClass = (dl-now)/3600000<24&&t.status!=='done'?'deadline-near':'';
      deadlineStr = `üìÖ ${dl.toLocaleString('vi-VN',{day:'2-digit',month:'2-digit',hour:'2-digit',minute:'2-digit'})}`;
    }
    return `<div class="task-card">
      <div class="subject-dot" style="background:${color}"></div>
      <div class="task-info">
        <div class="task-name" style="${t.status==='done'?'text-decoration:line-through;color:#94a3b8':''}">${t.name}</div>
        <div class="task-meta">
          <span>${t.subject||'Kh√¥ng c√≥ m√¥n'}</span>
          ${deadlineStr?`<span class="${deadlineClass}">${deadlineStr}</span>`:''}
        </div>
      </div>
      <button class="status-badge status-${t.status}" onclick="cycleStatus(${t.id})">${statusLabel}</button>
      <button class="del-btn" onclick="deleteTask(${t.id})">‚úï</button>
    </div>`;
  }).join('');
}

// ---- APPOINTMENTS ----
function saveApt() {
  const title = document.getElementById('a-title').value.trim();
  if (!title) return alert('Vui l√≤ng nh·∫≠p ti√™u ƒë·ªÅ!');
  const start = document.getElementById('a-start').value;
  if (!start) return alert('Vui l√≤ng ch·ªçn ng√†y gi·ªù!');
  data.appointments.push({ id:Date.now(), title, start, end:document.getElementById('a-end').value, location:document.getElementById('a-location').value.trim(), remind:document.getElementById('a-remind').value });
  saveData(); closeModal('apt'); renderApts();
  ['a-title','a-location','a-start','a-end'].forEach(id=>document.getElementById(id).value='');
}
function deleteApt(id) { data.appointments=data.appointments.filter(a=>a.id!==id); saveData(); renderApts(); }
function renderApts() {
  const now = new Date();
  const sorted = [...data.appointments].sort((a,b)=>new Date(a.start)-new Date(b.start));
  const el = document.getElementById('apt-list');
  if (!sorted.length) { el.innerHTML='<div class="empty-state"><div>üì≠</div>Ch∆∞a c√≥ cu·ªôc h·∫πn n√†o</div>'; return; }
  el.innerHTML = sorted.map(a => {
    const start = new Date(a.start);
    const isPast = start < now;
    const remindLabel = {10:'10 ph√∫t',30:'30 ph√∫t',60:'1 gi·ªù',1440:'1 ng√†y'}[a.remind]||'';
    const dateStr = start.toLocaleString('vi-VN',{weekday:'short',day:'2-digit',month:'2-digit',year:'numeric',hour:'2-digit',minute:'2-digit'});
    const endStr = a.end ? ` ‚Äì ${new Date(a.end).toLocaleTimeString('vi-VN',{hour:'2-digit',minute:'2-digit'})}` : '';
    return `<div class="apt-card" style="opacity:${isPast?.65:1}">
      <div class="apt-icon">${isPast?'‚úÖ':'üóìÔ∏è'}</div>
      <div class="apt-info">
        <div class="apt-title">${a.title}</div>
        <div class="apt-meta">
          <span>üïê ${dateStr}${endStr}</span>
          ${a.location?`<span>üìç ${a.location}</span>`:''}
        </div>
        ${remindLabel?`<div style="margin-top:5px"><span class="reminder-badge">üîî Nh·∫Øc tr∆∞·ªõc ${remindLabel}</span></div>`:''}
      </div>
      <button class="del-btn" onclick="deleteApt(${a.id})">‚úï</button>
    </div>`;
  }).join('');
}

function init() {
  document.getElementById('today-date').textContent =
    new Date().toLocaleDateString('vi-VN',{weekday:'long',day:'2-digit',month:'2-digit',year:'numeric'});
  renderSchedule();
}

loadData();

document.querySelectorAll('.modal-bg').forEach(bg => {
  bg.addEventListener('click', e => { if (e.target===bg) closeModal(bg.id.replace('modal-','')); });
});
</script>
</body>
</html>
